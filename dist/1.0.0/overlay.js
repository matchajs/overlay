define("matcha/overlay/1.0.0/overlay",["jquery","matcha/widget/1.0.0/widget","matcha/position/1.0.0/position","matcha/iframeshim/1.0.0/iframeshim"],function(a,b,c){function d(a){for(var b=i.allOverlays,c=0,d=b.length;d>c;c++)a.call(b,b[c],c)}var e=a("jquery"),f=a("matcha/widget/1.0.0/widget"),g=a("matcha/position/1.0.0/position"),h=a("matcha/iframeshim/1.0.0/iframeshim"),i=f.extend({attrs:{width:null,height:null,visible:!1,blurHide:!0,zIndex:99,align:{elementPos:"0 0",targetNode:!1,targetPos:"0 0"}},_setupShim:function(){var a=this,b=new h(a.$el),c=function(){b.position()};a.on("change:width",c),a.on("change:height",c),a._iframeShim=b},_setPosition:function(){var a=this;if(e.contains(document.documentElement,a.el)){var b=a.get("align");if(b){var c="none"===a.$el.css("display");return c&&a.$el.css({visibility:"hidden",display:"block"}),g({element:a.$el,pos:b.elementPos},{element:b.targetNode,pos:b.targetPos}),c&&a.$el.css({visibility:"",display:"none"}),a._iframeShim.position(),a}}},_setupResize:function(){i.allOverlays.push(this)},_blurHide:function(a){var b=this;a=e.makeArray(a),a.push(b.$el),b._relativeElements=a},setup:function(){var a=this;a._setupShim(),a._setupResize(),a.on("change:width",function(b,c){a.$el.css("width",c)}),a.on("change:height",function(b,c){a.$el.css("height",c)}),a.on("change:zIndex",function(b,c){a.$el.css("zIndex",c)}),a.on("change:align",function(){a._setPosition()}),a.on("change:visible",function(b,c){a.$el[c?"show":"hide"]()})},render:function(){var a=this;f.prototype.render.apply(a,arguments);var b=a.$el.css("position");("static"===b||"relative"===b)&&a.$el.css({position:"absolute",left:"-9999px",top:"-9999px"});var c=a.get("width");c&&a.$el.css("width",c);var d=a.get("height");return d&&a.$el.css("height",d),a},show:function(){var a=this;return a.rendered||a.render(),a.set("visible",!0),a._setPosition(),a},hide:function(){var a=this;return a.set("visible",!1),a._iframeShim.hide(),a},remove:function(){var a=this;return a._iframeShim.remove(),d(function(b,c){return a===b?(this.splice(c,1),this):void 0}),f.prototype.remove.apply(a,arguments),a}});i.allOverlays=[],c.exports=i,e(document).on("mousedown",function(a){d(function(b){if(b&&b.get("visible")&&b.get("blurHide")&&b._relativeElements){for(var c,d=0,f=b.relativeElements.length;f>d;d++)if(c=e(b.relativeElements[d])[0],c===a.target||e.contains(c,a.target))return;b.hide()}})});var j,k,l,m=e(window);m.resize(function(){l&&(clearTimeout(l),l=null),l=setTimeout(function(){var a=m.width(),b=m.height();(a!==j||b!==k)&&(d(function(a){a.get("visible")&&a._setPosition()}),j=a,k=b)},50)})});